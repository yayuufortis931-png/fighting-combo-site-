<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>A.K.Iおすすめコンボ</title>
<style>
body { 
  font-family: Arial, sans-serif; 
  padding: 20px; 
  background: #f9f9f9; 
}
h2 { 
  text-align: center; 
  margin-bottom: 30px; 
}

/* 戻るボタン */
.back-buttons { 
  margin-bottom: 20px; 
  text-align: center; 
}
.back-buttons button {
  margin: 0 5px;
  padding: 6px 12px;
  border: none;
  border-radius: 5px;
  background: #888;
  color: #fff;
  cursor: pointer;
}

/* 横並びラッパー */
.combo-row-wrapper {
  display: flex;
  align-items: flex-start;
  gap: 12px; 
  margin-bottom: 25px;
  flex-wrap: wrap; /* スマホでも折り返し */
}

/* コンボカード */
.combo-card {
  background: #f0f0f0;       /* 管理ページの背景に合わせる */
  border-radius: 12px;
  padding: 15px;
  flex: 1;
  display: flex;
  flex-direction: column;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

/* タイトル */
.combo-title { 
  font-weight: bold; 
  font-size: 16px; 
  margin-bottom: 10px; 
  text-align: left;
  padding: 5px 0;
}

/* 技画像コンテナ */
.moves-container { 
  display: flex; 
  flex-wrap: wrap; 
  gap: 10px; /* 管理ページに揃える */
}

.moves-container img { 
  width: 120px; 
  height: 120px; 
  object-fit: contain; 
  border: none;      /* 余計な枠を削除 */
  border-radius: 8px; 
  background: #f9f9f9; 
  padding: 0; 
}

/* サイドバナー */
.side-banner {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  color: #000;
  font-size: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 5px;
  width: 100px;
  flex-shrink: 0;
}

.side-banner img {
  width: auto;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  margin-bottom: 5px;
}

/* Amazonロゴ */
.amazon-logo {
  width: 30px;
  margin-top: 2px;
}

/* スマホ対応 */
@media (max-width: 480px) {
  .combo-row-wrapper {
    flex-direction: column;
  }
  .side-banner {
    width: 60px;
    font-size: 10px;
    padding: 3px;
  }
  .side-banner img {
    width: 60px;
    height: auto;
    margin-bottom: 2px;
  }
  .amazon-logo {
    width: 25px;
  }
}
</style>
</head>
<body>

<h2>A.K.Iおすすめコンボ</h2>

<div class="back-buttons">
  <button onclick="location.href='index.html'">🏠 トップへ戻る</button>
  <button onclick="location.href='aki.html'">✏️ コンボ管理ページへ戻る</button>
</div>

<div id="combo-display"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

// Firebase 設定
const firebaseConfig = {
  apiKey: "AIzaSyAD4fyc-1VlEEGGO631hhpZqCOqllrQ3og",
  authDomain: "st6-combo-maker.firebaseapp.com",
  projectId: "st6-combo-maker",
  storageBucket: "st6-combo-maker.firebasestorage.app",
  messagingSenderId: "945906359459",
  appId: "1:945906359459:web:59a955b609426cf2893316",
  measurementId: "G-YVFY7H6N9E"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const comboDisplay = document.getElementById("combo-display");

// サイドバナー用商品リスト
const affiliateItems = [
  { link:"https://amzn.to/45LDjGS", img:"https://m.media-amazon.com/images/I/71efVUNIBmL._AC_SL1500_.jpg", title:"BLITZ2" },
  { link:"https://amzn.to/4ng309J", img:"https://m.media-amazon.com/images/I/71a0xYAmg0L._AC_SX679_.jpg", title:"Haute42 アケコン" },
  { link:"https://amzn.to/41h5CLP", img:"https://m.media-amazon.com/images/I/61T5L-yGdJL._AC_SX679_.jpg", title:"ファイティングスティックα" },
  { link:"https://amzn.to/463TZdK", img:"https://m.media-amazon.com/images/I/61ZkF5cY7zL._AC_SY450_.jpg", title:"Elgato Wave:3" },
  { link:"https://amzn.to/47JHeq7", img:"https://m.media-amazon.com/images/I/61uDYXfqtxL._AC_SX679_.jpg", title:"ロジクール MX MASTER3s" },
  { link:"https://amzn.to/3VcypNZ", img:"https://m.media-amazon.com/images/I/61euaIRYGXL._AC_SY300_SX300_QL70_ML2_.jpg", title:"HyperX QuadCast S" }
];

const amazonLogo = "https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg";

// A.K.I用ドキュメント
const docRef = doc(db, "combos", "A.K.I");

// リアルタイム取得
onSnapshot(docRef, (docSnap) => {
  comboDisplay.innerHTML = "";
  if (docSnap.exists()) {
    const rows = docSnap.data().rows || [];
    rows.forEach((r, index) => {
      const wrapper = document.createElement("div");
      wrapper.className = "combo-row-wrapper";

      // コンボカード
      const card = document.createElement("div");
      card.className = "combo-card";

      const title = document.createElement("div");
      title.className = "combo-title";
      title.textContent = r.title;
      card.appendChild(title);

      const movesContainer = document.createElement("div");
      movesContainer.className = "moves-container";

      r.moves.forEach(mv => {
        const img = document.createElement("img");
        img.src = `images/aki/${mv}.png`;
        img.alt = mv;
        movesContainer.appendChild(img);
      });

      card.appendChild(movesContainer);
      wrapper.appendChild(card);

      // サイドバナー（1つだけ、カードの高さを超えないように）
      const item = affiliateItems[index % affiliateItems.length];
      const sideLink = document.createElement("a");
      sideLink.href = item.link;
      sideLink.target = "_blank";
      sideLink.className = "side-banner";

      const sideImg = document.createElement("img");
      sideImg.src = item.img;
      sideImg.alt = item.title;
      sideImg.style.maxHeight = card.offsetHeight - 40 + "px";
      sideLink.appendChild(sideImg);

      const sideTitle = document.createElement("div");
      sideTitle.textContent = item.title;
      sideLink.appendChild(sideTitle);

      const logoImg = document.createElement("img");
      logoImg.src = amazonLogo;
      logoImg.className = "amazon-logo";
      sideLink.appendChild(logoImg);

      wrapper.appendChild(sideLink);
      comboDisplay.appendChild(wrapper);
    });
  } else {
    comboDisplay.innerHTML = "<p>おすすめコンボがまだ登録されていません。</p>";
  }
});
</script>

</body>
</html>
